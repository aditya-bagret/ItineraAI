{% extends 'base.html' %}

{% block title %}AI Trip Planner - Home{% endblock %}

{% block content %}

<div class="row">
    <div class="col-md-12 text-center mb-5">
        <h1 class="display-4">Plan Your Perfect Trip with AI</h1>
        <p class="lead">Create personalized travel itineraries powered by artificial intelligence</p>
        {% if session.logged_in %}
        <a href="{{ url_for('trip.new_trip') }}" class="btn btn-primary btn-lg mt-3">
            <i class="fas fa-plus me-2"></i>Create New Trip
        </a>
        {% else %}
        <a href="{{ url_for('auth.register') }}" class="btn btn-primary btn-lg mt-3">
            <i class="fas fa-user-plus me-2"></i>Sign Up Now
        </a>
        {% endif %}
    </div>
</div>

<div class="row mb-5">
    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-body text-center">
                <i class="fas fa-robot fa-3x text-primary mb-3"></i>
                <h3 class="card-title">AI-Powered Itineraries</h3>
                <p class="card-text">Our advanced AI creates personalized travel plans based on your preferences, budget, and travel dates.</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-body text-center">
                <i class="fas fa-plane-departure fa-3x text-primary mb-3"></i>
                <h3 class="card-title">Real-Time Bookings</h3>
                <p class="card-text">Search and book flights, hotels, and activities with real-time availability and pricing.</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-body text-center">
                <i class="fas fa-cloud-sun fa-3x text-primary mb-3"></i>
                <h3 class="card-title">Weather Forecasts</h3>
                <p class="card-text">Get accurate weather forecasts Plants</p>
            </div>
        </div>
    </div>
</div>

<!-- Chatbot Open Button and Widget Section -->
<div class="row mb-5 position-relative" id="chatbot-section">
    <div class="col-md-12 text-center">
        <button id="chatbot-open" class="btn btn-primary rounded-circle" aria-label="Open chatbot"><i class="fas fa-suitcase"></i></button>
    </div>
    <!-- Chatbot Outer Container -->
    <div id="chatbot-outer-container" class="col-md-8 offset-md-2">
        <!-- Chatbot Widget -->
        <div id="chatbot-container">
            <div id="chatbot-header">
                <span>Travel Assistant</span>
                <div>
                    <button id="chatbot-toggle" class="toggle-btn" aria-label="Minimize chatbot">âˆ’</button>
                </div>
            </div>
            <div id="chatbot-messages">
                <div id="message-wrapper"></div>
            </div>
            <div id="chatbot-input">
                <input type="text" id="chatbot-input-field" class="form-control" placeholder="Ask about your trip...">
                <button id="chatbot-send" class="btn btn-primary" aria-label="Send message"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>
    </div>
</div>

<div class="row mb-5">
    <div class="col-md-6">
        <h2 class="mb-4">How It Works</h2>
        <div class="accordion" id="howItWorks">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">
                        <i class="fas fa-1 me-2"></i>Create Your Trip
                    </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#howItWorks">
                    <div class="accordion-body">
                        Enter your destination, travel dates, budget, and preferences. Our AI will generate a personalized itinerary for your trip.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo">
                        <i class="fas fa-2 me-2"></i>Customize Your Itinerary
                    </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#howItWorks">
                    <div class="accordion-body">
                        Review your AI-generated itinerary and make any adjustments to fit your preferences. You can regenerate the itinerary as many times as you want.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree">
                        <i class="fas fa-3 me-2"></i>Book Your Trip
                    </button>
                </h2>
                <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#howItWorks">
                    <div class="accordion-body">
                        Search for flights, hotels, and activities based on your itinerary. Check real-time availability and prices before booking.
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour">
                        <i class="fas fa-4 me-2"></i>Enjoy Your Trip
                    </button>
                </h2>
                <div id="collapseFour" class="accordion-collapse collapse" data-bs-parent="#howItWorks">
                    <div class="accordion-body">
                        Access your itinerary and bookings anytime, anywhere. Get weather updates and local information during your trip.
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <h2 class="mb-4">Popular Destinations</h2>
        <div id="destinationCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#destinationCarousel" data-bs-slide-to="0" class="active"></button>
                <button type="button" data-bs-target="#destinationCarousel" data-bs-slide-to="1"></button>
                <button type="button" data-bs-target="#destinationCarousel" data-bs-slide-to="2"></button>
                <button type="button" data-bs-target="#destinationCarousel" data-bs-slide-to="3"></button>
            </div>
            <div class="carousel-inner rounded">
                <div class="carousel-item active">
                    <img src="https://images.unsplash.com/photo-1502602898657-3e91760cbb34?q=80&w=2073&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" class="d-block w-100" alt="Paris">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>Paris, France</h5>
                        <p>The City of Light awaits with its iconic landmarks and romantic atmosphere.</p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="https://images.unsplash.com/photo-1617870435601-4a5d43be4bd7?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" class="d-block w-100" alt="Tokyo">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>Tokyo, Japan</h5>
                        <p>Experience the perfect blend of traditional culture and futuristic technology.</p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="https://images.unsplash.com/photo-1548182880-8b7b2af2caa2?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" class="d-block w-100" alt="New York">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>New York, USA</h5>
                        <p>The city that never sleeps offers endless entertainment and iconic sights.</p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="https://plus.unsplash.com/premium_photo-1677829177642-30def98b0963?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" class="d-block w-100" alt="Bali">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>Bali, Indonesia</h5>
                        <p>Relax on beautiful beaches and immerse yourself in rich cultural experiences.</p>
                    </div>
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#destinationCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#destinationCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
</div>

<div class="row mb-5">
    <div class="col-md-12 text-center">
        <h2 class="mb-4">What Our Users Say</h2>
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <div class="d-flex justify-content-center mb-3">
                            <span class="text-warning">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </span>
                        </div>
                        <p class="card-text">"The AI-generated itinerary was perfect for our family vacation to Disney World. It saved us so much time planning!"</p>
                        <p class="card-text"><small class="text-muted">- Sarah J.</small></p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <div class="d-flex justify-content-center mb-3">
                            <span class="text-warning">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </span>
                        </div>
                        <p class="card-text">"I was skeptical about AI planning my trip to Japan, but it created an amazing itinerary that included both popular spots and hidden gems."</p>
                        <p class="card-text"><small class="text-muted">- Michael T.</small></p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <div class="d-flex justify-content-center mb-3">
                            <span class="text-warning">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </span>
                        </div>
                        <p class="card-text">"The real-time booking feature saved us money on our flights and hotels. We'll definitely use this for all our future trips!"</p>
                        <p class="card-text"><small class="text-muted">- Emily & David</small></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% if not session.logged_in %}
<div class="row">
    <div class="col-md-12 text-center">
        <div class="card bg-light">
            <div class="card-body py-5">
                <h2 class="card-title mb-4">Ready to Plan Your Next Adventure?</h2>
                <p class="card-text mb-4">Join thousands of travelers who use AI Trip Planner to create unforgettable experiences.</p>
                <a href="{{ url_for('auth.register') }}" class="btn btn-primary btn-lg me-3">
                    <i class="fas fa-user-plus me-2"></i>Sign Up Now
                </a>
                <a href="{{ url_for('auth.login') }}" class="btn btn-outline-primary btn-lg">
                    <i class="fas fa-sign-in-alt me-2"></i>Login
                </a>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Inline Chatbot Styles -->
<style>
/* Outer Container Styles */
#chatbot-outer-container {
    margin-top: 20px;
    background: #F5F5DC; /* Beige background */
    border-radius: 20px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
    padding: 20px;
    z-index: 1000;
    display: none;
}

/* Base Styles */
#chatbot-container {
    width: 100%;
    max-height: 600px;
    background: #F5F5DC; /* Beige background */
    border-radius: 10px;
    box-shadow: none;
    display: flex;
    flex-direction: column;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    animation: slideInFromBottom 0.5s ease forwards;
}

#chatbot-header {
    background: #D4E4D6; /* Pastel green for header */
    color: #666; /* Soft gray text */
    padding: 12px 15px;
    border-bottom: 1px solid #e0e0e0;
    border-radius: 10px 10px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 16px;
    font-weight: 600;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    min-height: 50px;
}

#chatbot-header::before {
    content: '\f4fe'; /* Font Awesome robot icon */
    font-family: 'Font Awesome 6 Free';
    font-weight: 900;
    margin-right: 8px;
    font-size: 18px;
    color: #A3CFFA; /* Pastel blue for icon */
}

#chatbot-messages {
    flex-grow: 1;
    padding: 15px;
    overflow-y: auto;
    max-height: 450px;
    background: #F5F5DC; /* Beige background */
}

#message-wrapper {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.welcome-message {
    background: #D4E4D6; /* Pastel green for welcome message */
    border-radius: 10px;
    padding: 12px;
    margin: 0 auto;
    text-align: center;
    color: #666; /* Soft gray text */
    font-size: 14px;
    font-weight: 500;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid #e0e0e0;
    max-width: 80%;
    opacity: 0;
    animation: fadeIn 0.5s ease forwards;
}

.welcome-message i {
    margin-right: 8px;
    color: #A3CFFA; /* Pastel blue for icon */
}

.message {
    display: flex;
    align-items: flex-start;
    margin: 0;
    opacity: 0;
    animation: fadeIn 0.5s ease forwards;
}

.message-header {
    display: flex;
    align-items: center;
    font-size: 12px;
    font-weight: 600;
    margin-bottom: 5px;
}

.message-header i {
    margin-right: 5px;
}

.user-message {
    justify-content: flex-end;
}

.user-message .message-header {
    color: #A3CFFA; /* Pastel blue for user message header */
}

.user-message .message-content {
    background: #E6F0FA; /* Very light pastel blue for user messages */
    border-radius: 10px 10px 0 10px;
    border: 1px solid #A3CFFA; /* Pastel blue border */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    max-width: 80%;
    padding: 10px 12px;
    font-size: 14px;
    line-height: 1.5;
    color: #666; /* Soft gray text */
}

.assistant-message {
    justify-content: flex-start;
}

.assistant-message .message-header {
    color: #D4E4D6; /* Pastel green for assistant message header */
}

.assistant-message .message-content {
    background: #E8F5E9; /* Very light pastel green for assistant messages */
    border-radius: 10px 10px 10px 0;
    border: 1px solid #D4E4D6; /* Pastel green border */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    max-width: 80%;
    padding: 10px 12px;
    font-size: 14px;
    line-height: 1.5;
    color: #666; /* Soft gray text */
}

.avatar {
    display: none; /* Remove avatar since we're using labels now */
}

#chatbot-input {
    display: flex;
    padding: 10px;
    border-top: 1px solid #e0e0e0;
    background: #F5F5DC; /* Beige background */
    border-radius: 0 0 10px 10px;
    box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.05);
}

#chatbot-input-field {
    flex-grow: 1;
    padding: 8px 12px;
    border: 1px solid #e0e0e0;
    border-radius: 20px;
    font-size: 14px;
    outline: none;
    background: #F5F5DC; /* Beige background */
    color: #666; /* Soft gray text */
    transition: border-color 0.3s ease;
}

#chatbot-input-field:focus {
    border-color: #A3CFFA; /* Pastel blue border on focus */
    box-shadow: 0 0 5px rgba(163, 207, 250, 0.2);
}

#chatbot-send {
    margin-left: 8px;
    padding: 8px;
    background: #A3CFFA; /* Pastel blue for send button */
    color: #fff;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.3s ease, transform 0.2s ease;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

#chatbot-send:hover {
    background: #82B1FF; /* Slightly darker pastel blue on hover */
    transform: scale(1.1);
}

#chatbot-open {
    width: 60px;
    height: 60px;
    background: #A3CFFA; /* Pastel blue for open button */
    color: #fff;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 6px 20px rgba(163, 207, 250, 0.4);
    font-size: 24px;
    animation: pulse 2s infinite;
}

#chatbot-open:hover {
    background: #82B1FF; /* Slightly darker pastel blue on hover */
    box-shadow: 0 8px 25px rgba(163, 207, 250, 0.6);
    animation: bounce 0.5s;
}

.toggle-btn {
    background: none;
    border: none;
    color: #A3CFFA; /* Pastel blue for toggle button */
    font-size: 16px;
    cursor: pointer;
    transition: color 0.3s ease;
}

.toggle-btn:hover {
    color: #82B1FF; /* Slightly darker pastel blue on hover */
}

.toggle-btn::before {
    content: '\f068'; /* Font Awesome minus icon */
    font-family: 'Font Awesome 6 Free';
    font-weight: 900;
}

.toggle-btn.minimized::before {
    content: '\f067'; /* Font Awesome plus icon */
}

.typing-indicator {
    background: #E8F5E9; /* Very light pastel green for typing indicator */
    border-radius: 10px;
    padding: 10px 12px;
    margin: 0 5px;
    max-width: 80%;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid #D4E4D6; /* Pastel green border */
    font-size: 12px;
    color: #666; /* Soft gray text */
    opacity: 0;
    animation: fadeIn 0.5s ease forwards;
}

.typing-indicator .dot {
    display: inline-block;
    width: 6px;
    height: 6px;
    background: #A3CFFA; /* Pastel blue for dots */
    border-radius: 50%;
    margin: 0 2px;
    animation: dot-blink 1.4s infinite both;
}

.typing-indicator .dot:nth-child(2) {
    animation-delay: 0.2s;
}

.typing-indicator .dot:nth-child(3) {
    animation-delay: 0.4s;
}

/* Animations */
@keyframes slideInFromBottom {
    from {
        opacity: 0;
        transform: translateY(100px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes dot-blink {
    0%, 20% {
        opacity: 1;
    }
    40%, 100% {
        opacity: 0.3;
    }
}

@keyframes bounce {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-10px);
    }
}

@keyframes pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(163, 207, 250, 0.7);
    }
    70% {
        box-shadow: 0 0 0 15px rgba(163, 207, 250, 0);
    }
    100% {
        box-shadow: 0 0 0 0 rgba(163, 207, 250, 0);
    }
}

/* Responsive Design */
@media (max-width: 576px) {
    #chatbot-outer-container {
        width: 100%;
        padding: 10px;
    }

    #chatbot-container {
        width: 100%;
        max-height: 80vh;
    }

    #chatbot-open {
        width: 50px;
        height: 50px;
        font-size: 20px;
    }

    #chatbot-messages {
        max-height: 60vh;
    }
}
</style>

<!-- Chatbot Scripts -->
<script src="{{ url_for('static', filename='js/chatbot.js') }}"></script>
{% endblock %}